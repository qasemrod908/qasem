# تطبيق معهد القاسم للعلوم واللغات

## نبذة عامة
تطبيق ويب شامل تم تطويره باستخدام Flask وPython مع قاعدة بيانات SQLite، مصمم لإدارة معهد تعليمي بالكامل باللغة العربية. يوفر التطبيق نظام إدارة متكامل للمستخدمين، الدورات التدريبية، الأخبار، مع نظام مصادقة قوي يدعم أربعة أدوار (مدير، معاون، مدرس، طالب) ونظام نسخ احتياطي متطور مع دعم التيليجرام.

## تفضيلات المستخدم
- جميع الاتصالات باللغة العربية
- شرح واضح ومختصر
- الإبلاغ عن التغييرات المهمة قبل تنفيذها
- إعطاء الأولوية للأمان وسلامة البيانات

## البنية التقنية

### التقنيات المستخدمة
- **الواجهة الخلفية**: Flask (Python 3.11)
- **قاعدة البيانات**: SQLite
- **المصادقة**: Flask-Login مع تسجيل دخول برقم الجوال وتشفير كلمات المرور (Werkzeug)
- **النماذج**: Flask-WTF مع حماية CSRF
- **إدارة الملفات**: رفع الصور والملفات مع حد أقصى 16 MB
- **النسخ الاحتياطي**: خيارات متعددة (شامل، بنية، بيانات) مع إرسال تلقائي للتيليجرام
- **التكامل مع التيليجرام**: إدارة كاملة من لوحة التحكم

### الميزات الرئيسية
- **إدارة المستخدمين**: إضافة، تعديل، حذف، تفعيل/تعطيل المستخدمين مع صلاحيات متقدمة
- **إدارة الدورات**: إضافة، تعديل، حذف الدورات مع رفع الصور
- **إدارة الأخبار**: إضافة، تعديل، حذف الأخبار مع رفع الصور
- **إدارة المدرسين**: تعديل بيانات المدرسين (التخصص، النبذة، المؤهلات، الخبرة، الصورة)
- **نظام الدروس**: رفع الدروس من المدرسين، إمكانية التحميل والعرض للطلاب المسجلين فقط
- **نظام العلامات**: تسجيل وعرض العلامات للطلاب
- **استمارة اتصل بنا**: مع إرسال تلقائي للتيليجرام
- **النسخ الاحتياطي المتقدم**: عرض، تحميل، استعادة النسخ الاحتياطية

## إعدادات Telegram (اختيارية)

لتفعيل إرسال النسخ الاحتياطية وإشعارات "اتصل بنا" إلى Telegram:

1. إنشاء بوت عبر [@BotFather](https://t.me/BotFather)
2. الحصول على Bot Token
3. الحصول على Chat ID (يمكن الحصول عليه من [@userinfobot](https://t.me/userinfobot))
4. تسجيل الدخول إلى لوحة التحكم الإدارية
5. الانتقال إلى صفحة الإعدادات
6. إدخال Bot Token و Chat ID في قسم "إعدادات بوت التيليجرام"
7. تفعيل الخيار "تفعيل إرسال النسخ الاحتياطية إلى Telegram"
8. حفظ التغييرات

**ملاحظة**: لم تعد هناك حاجة لاستخدام متغيرات البيئة (Secrets) - يمكن التحكم بكل شيء من لوحة الإدارة!

## الإصلاحات والتحديثات الأخيرة

### 22 أكتوبر 2025 - التحديث المسائي (الجزء الثاني)
- ✅ **تحسينات إدارة المستخدمين الاحترافية**:
  - واجهة محسّنة مع badges ملونة حسب نوع المستخدم
  - خيارات تفعيل/تعطيل المستخدمين
  - خيار حذف المستخدمين مع حماية من حذف الحساب الحالي
  - عرض تاريخ الإنشاء لكل مستخدم
  - تصميم احترافي مع أيقونات وتنسيق محسّن

- ✅ **إضافة رابط إدارة المدرسين**:
  - ظهور رابط "إدارة المدرسين" في لوحة التحكم الإدارية
  - سهولة الوصول لصفحة تعديل بيانات المدرسين

- ✅ **إخفاء الدروس من الزوار**:
  - الدروس لا تظهر للزوار في صفحات تفاصيل الدورات
  - الدروس لا تظهر للزوار في صفحات تفاصيل المدرسين
  - الدروس متاحة فقط للطلاب المسجلين

- ✅ **إصلاح وظيفة إرسال النسخ الاحتياطية للتيليجرام**:
  - استخدام threading لتجنب مشاكل event loop
  - إرسال النسخ الاحتياطية في الخلفية دون تعطيل الطلب

- ✅ **إرسال إشعارات "اتصل بنا" للتيليجرام**:
  - عند إرسال استمارة "اتصل بنا"، يتم إرسال نسخة تلقائياً للتيليجرام
  - رسالة منسقة تحتوي على جميع معلومات الاتصال
  - استخدام threading لضمان عدم تأخير الاستجابة

- ✅ **إصلاح مشكلة إضافة الطالب**:
  - تصحيح حقول Student model عند الإنشاء
  - استخدام الحقول الصحيحة (student_number, date_of_birth)

### 22 أكتوبر 2025 - التحديث المسائي (الجزء الأول)
- ✅ **إدارة إعدادات Telegram من لوحة التحكم**:
  - إضافة حقول إعدادات Telegram في جدول الإعدادات
  - إمكانية إدخال Bot Token و Chat ID من صفحة الإعدادات
  - عدم الحاجة لاستخدام متغيرات البيئة (Secrets)

- ✅ **تحسينات الأمان**:
  - إخفاء الحساب التجريبي من صفحة تسجيل الدخول
  - إصلاح ثغرة path traversal في تحميل النسخ الاحتياطية

- ✅ **نظام النسخ الاحتياطي المحسّن**:
  - عرض قائمة النسخ الاحتياطية المتوفرة
  - إمكانية تحميل أي نسخة احتياطية
  - واجهة رفع واستعادة النسخ

- ✅ **إدارة شاملة للمدرسين**:
  - صفحة عرض جميع المدرسين
  - تعديل كامل بيانات المدرس

- ✅ **نظام دروس محسّن للطلاب**:
  - الدروس للطلاب المسجلين فقط
  - أزرار تحميل وعرض الدروس

---
**تم التطوير بواسطة**: Replit Agent
**التاريخ**: 2025
**الإصدار**: 1.3.0
