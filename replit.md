# تطبيق معهد القاسم للعلوم واللغات

## نظرة عامة
تطبيق ويب متكامل لإدارة معهد تعليمي باللغة العربية، مبني باستخدام Flask وPython، مع قاعدة بيانات SQLite.

## المميزات الرئيسية

### 1. نظام المصادقة والصلاحيات
- تسجيل الدخول برقم الجوال وكلمة المرور
- أربعة أنواع من المستخدمين:
  - **المدير**: صلاحيات كاملة على النظام
  - **معاون المدير**: صلاحيات قابلة للتخصيص
  - **الأساتذة**: رفع دروس PDF، إضافة علامات، ملاحظات
  - **الطلاب**: عرض الدروس، العلامات، الملاحظات

### 2. لوحة التحكم الإدارية
- إدارة المستخدمين (إضافة، تعديل، حذف)
- إدارة الدورات التعليمية (إضافة، تعديل، حذف) مع دعم الصور
- إدارة الأخبار (إضافة، تعديل، حذف) مع دعم الصور
- إعدادات الموقع الشاملة
- نظام النسخ الاحتياطي المتقدم

### 3. نظام النسخ الاحتياطي
- **نسخ احتياطي كامل**: قاعدة البيانات + الملفات
- **نسخ احتياطي للبنية**: القوالب + CSS + JS
- **نسخ احتياطي للبيانات**: قاعدة البيانات فقط
- إرسال تلقائي إلى Telegram (اختياري)

### 4. الصفحة الرئيسية للزوار
- قسم تعريفي بالمعهد
- عرض الدورات المميزة مع روابط لصفحات التفاصيل
- معلومات عن المدرسين مع صفحة تفاصيل لكل مدرس
- آخر الأخبار مع روابط للأخبار الكاملة
- آراء الطلاب وشهادات
- معلومات التواصل

### 5. لوحات التحكم المخصصة
- **لوحة الأساتذة**: إدارة الدروس، الطلاب، العلامات
- **لوحة الطلاب**: عرض الدورات، تحميل الدروس، العلامات

## البنية التقنية

### التقنيات المستخدمة
- **Backend**: Flask (Python 3.11)
- **قاعدة البيانات**: SQLite
- **Frontend**: Bootstrap 5, Font Awesome
- **المصادقة**: Flask-Login
- **النماذج**: Flask-WTF
- **التكامل**: Telegram Bot API

### هيكل المشروع
```
معهد-القاسم/
├── app/
│   ├── models/          # نماذج قاعدة البيانات
│   ├── routes/          # المسارات (auth, admin, teacher, student, public)
│   ├── templates/       # القوالب HTML
│   ├── static/          # الملفات الثابتة (CSS, JS, uploads)
│   └── utils/           # أدوات مساعدة (backup, decorators)
├── backups/             # مجلد النسخ الاحتياطية
├── config.py            # الإعدادات
├── main.py              # نقطة البداية
└── alqasim_institute.db # قاعدة البيانات
```

## التثبيت والتشغيل

### بيانات الدخول الافتراضية
- **رقم الجوال**: 0501234567
- **كلمة المرور**: admin123

⚠️ **تحذير أمني**: يجب تغيير كلمة المرور الافتراضية فوراً بعد أول تسجيل دخول من خلال:
1. تسجيل الدخول باستخدام البيانات أعلاه
2. الانتقال إلى: لوحة التحكم > إدارة المستخدمين
3. تعديل المستخدم الإداري وتغيير كلمة المرور

### تشغيل التطبيق
التطبيق يعمل تلقائياً على المنفذ 5000

## إعدادات Telegram (اختيارية)

لتفعيل إرسال النسخ الاحتياطية إلى Telegram:

1. إنشاء بوت عبر [@BotFather](https://t.me/BotFather)
2. الحصول على Bot Token
3. الحصول على Chat ID (يمكن الحصول عليه من [@userinfobot](https://t.me/userinfobot))
4. تسجيل الدخول إلى لوحة التحكم الإدارية
5. الانتقال إلى صفحة الإعدادات
6. إدخال Bot Token و Chat ID في قسم "إعدادات بوت التيليجرام"
7. تفعيل الخيار "تفعيل إرسال النسخ الاحتياطية إلى Telegram"
8. حفظ التغييرات

**ملاحظة**: لم تعد هناك حاجة لاستخدام متغيرات البيئة (Secrets) - يمكن التحكم بكل شيء من لوحة الإدارة!

## قاعدة البيانات

### الجداول الرئيسية
- `users` - المستخدمون
- `students` - الطلاب
- `teachers` - المدرسون
- `courses` - الدورات
- `enrollments` - التسجيلات
- `lessons` - الدروس
- `grades` - العلامات
- `news` - الأخبار
- `testimonials` - آراء الطلاب
- `certificates` - الشهادات
- `contacts` - رسائل التواصل
- `site_settings` - إعدادات الموقع

## الواجهات المتاحة

### للزوار
- `/` - الصفحة الرئيسية
- `/courses` - قائمة الدورات
- `/course/<id>` - صفحة تفاصيل الدورة
- `/teachers` - قائمة المدرسين
- `/teacher/<id>` - صفحة تفاصيل المدرس
- `/news` - قائمة الأخبار
- `/news/<id>` - صفحة تفاصيل الخبر
- `/contact` - اتصل بنا
- `/auth/login` - تسجيل الدخول (برقم الجوال)

### للإدارة
- `/admin/dashboard` - لوحة التحكم
- `/admin/users` - إدارة المستخدمين (إضافة/تعديل)
- `/admin/teachers` - إدارة المدرسين (عرض/تعديل)
- `/admin/teachers/edit/<id>` - تعديل بيانات مدرس
- `/admin/courses` - إدارة الدورات (إضافة/تعديل/حذف)
- `/admin/courses/edit/<id>` - تعديل دورة
- `/admin/news` - إدارة الأخبار (إضافة/تعديل/حذف)
- `/admin/news/edit/<id>` - تعديل خبر
- `/admin/settings` - الإعدادات (تشمل إعدادات Telegram)
- `/admin/backup` - النسخ الاحتياطي والاستعادة
- `/admin/backup/download/<filename>` - تحميل نسخة احتياطية
- `/admin/backup/restore` - استعادة نسخة احتياطية

### للأساتذة
- `/teacher/dashboard` - لوحة المدرس
- `/teacher/lessons` - دروسي
- `/teacher/add_lesson` - إضافة درس
- `/teacher/students` - طلابي

### للطلاب
- `/student/dashboard` - لوحة الطالب
- `/student/courses` - دوراتي
- `/student/lessons/<course_id>` - دروس الدورة
- `/student/lesson/download/<lesson_id>` - تحميل درس
- `/student/grades` - علاماتي

## الأمان
- تشفير كلمات المرور باستخدام Werkzeug
- نظام صلاحيات متقدم
- حماية CSRF في النماذج
- تحكم في أنواع الملفات المرفوعة
- حد أقصى لحجم الملفات (16 MB)

## التطوير المستقبلي
- إضافة نظام الإشعارات
- تقارير متقدمة وإحصائيات
- نظام الدفع الإلكتروني
- تطبيق الجوال
- نظام الحضور والغياب
- منتدى للطلاب

## الإصلاحات والتحديثات الأخيرة

### 22 أكتوبر 2025 - التحديث المسائي
- ✅ **إدارة إعدادات Telegram من لوحة التحكم**:
  - إضافة حقول إعدادات Telegram في جدول الإعدادات
  - إمكانية إدخال Bot Token و Chat ID من صفحة الإعدادات
  - عدم الحاجة لاستخدام متغيرات البيئة (Secrets)
  - تفعيل/تعطيل إرسال النسخ الاحتياطية إلى Telegram

- ✅ **تحسينات الأمان**:
  - إخفاء الحساب التجريبي من صفحة تسجيل الدخول
  - إصلاح ثغرة path traversal في تحميل النسخ الاحتياطية
  - إضافة فحص أمني لمنع الوصول غير المصرح

- ✅ **نظام النسخ الاحتياطي المحسّن**:
  - عرض قائمة النسخ الاحتياطية المتوفرة مع التاريخ والحجم
  - إمكانية تحميل أي نسخة احتياطية من القائمة
  - واجهة رفع نسخة احتياطية من الجهاز
  - خيارات استعادة متعددة (شامل/بنية/بيانات)
  - رسالة تحذيرية قبل الاستعادة

- ✅ **إدارة شاملة للمدرسين**:
  - صفحة عرض جميع المدرسين مع إحصائياتهم
  - إمكانية تعديل كامل بيانات المدرس:
    - التخصص والنبذة التعريفية
    - المؤهلات وسنوات الخبرة
    - رقم الهاتف والصورة الشخصية
  - عرض دروس كل مدرس في صفحة التعديل

- ✅ **نظام دروس محسّن للطلاب**:
  - الدروس تظهر فقط للطلاب المسجلين في الدورة
  - زر "تحميل الدرس" لتنزيل الملف
  - زر "فتح الدرس" لعرضه مباشرة
  - عرض نوع الملف (PDF, DOCX, etc)
  - حماية من محاولات التحميل غير المصرح بها
  - رسائل خطأ واضحة

- ✅ **تحسينات الصفحة الرئيسية**:
  - روابط قابلة للنقر على أسماء الدورات
  - روابط لصفحات تفاصيل المدرسين
  - أزرار "التفاصيل" و"عرض الملف" في البطاقات
  - تجربة مستخدم محسّنة للزوار

### 22 أكتوبر 2025 - التحديث الصباحي
- ✅ **تغيير نظام تسجيل الدخول**: الانتقال من البريد الإلكتروني إلى رقم الجوال
- ✅ **صفحات تفاصيل المدرسين**: إضافة صفحة مستقلة لكل مدرس تعرض:
  - صورة المدرس
  - النبذة الشخصية
  - المؤهلات
  - سنوات الخبرة
  - الدروس المنشورة
- ✅ **إدارة متقدمة للدورات**: إضافة إمكانيات:
  - تعديل الدورات الموجودة
  - حذف الدورات
  - رفع صور للدورات
  - صفحة تفاصيل مستقلة لكل دورة
- ✅ **إدارة متقدمة للأخبار**: إضافة إمكانيات:
  - تعديل الأخبار الموجودة
  - حذف الأخبار
  - رفع صور للأخبار
  - صفحة تفاصيل مستقلة لكل خبر
- ✅ **تحسينات واجهة المستخدم**: 
  - بطاقات محسنة للدورات والأخبار مع الصور
  - روابط سلسة للصفحات المستقلة
  - تصميم متجاوب ومتناسق

### 21 أكتوبر 2024
- ✅ إصلاح مشكلة "الملف الشخصي للمعلم غير موجود"
- ✅ إصلاح نظام النسخ الاحتياطي للبنية (schema export)
- ✅ إزالة كلمة المرور من السجلات لتحسين الأمان
- ✅ إضافة إنشاء تلقائي للملفات الشخصية للمعلمين والطلاب عند إضافة مستخدمين جدد

## ملاحظات مهمة

### إضافة مستخدمين جدد
- عند إضافة مستخدم من نوع "معلم"، يتم إنشاء ملف شخصي له تلقائياً في جدول المعلمين
- عند إضافة مستخدم من نوع "طالب"، يتم إنشاء ملف شخصي له تلقائياً في جدول الطلاب
- يمكن تحديث معلومات الملف الشخصي لاحقاً

### تغيير نوع المستخدم
- ⚠️ تغيير نوع المستخدم من "معلم" إلى نوع آخر سيحذف ملفه الشخصي والبيانات المرتبطة به
- تأكد من نقل أو حفظ أي بيانات مهمة قبل تغيير نوع المستخدم

## الدعم
للمساعدة أو الاستفسارات، يرجى التواصل مع المطور أو فريق الدعم.

---
**تم التطوير بواسطة**: Replit Agent
**التاريخ**: 2025
**الإصدار**: 1.2.0
